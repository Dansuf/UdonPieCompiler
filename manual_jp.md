UdonPie言語 日本語マニュアル
====

まえがき
----
* UdonPie言語はPythonの構文解析機を借りているため
  文法はPythonですが、意味論が違います。
  そのため、pythonとは別の言語となっています。
* このコンパイラの手書き部分は**1000行程度**です。
  コードが読める方は、コードを直接読むのもいいかもしれません。


インストール方法
----

1. UdonPie_release_x.x.x.zipを展開
2. 中身を自由な場所に配置する。
3. PathをUdonPieC.exeと同じディレクトリに通す。

コンパイル方法
----
（ソースファイルの拡張子は自由だが、
`py`にしておくとエディタのハイライトや
入力補完の恩恵が受けられる。）

```
> UdonPieC input_code.py output_assembly.uasm
```


イベント
----
イベントの定義は以下のように行う。
```py
def _イベント名(引数1: 引数1の型 ...) -> 戻り値の型:
  # イベント内部はインデントを1つ下げる
  イベント中身の処理
```


引数なしの例
```py
def _start():
  UnityEngineDebug.Log(SystemObject('start event!!!')))
```

引数ありの例
```py
def _onPlayerJoined(playerApi: VRCSDKBaseVRCPlayerApi):
  UnityEngineDebug.Log(SystemObject(playerApi))
```

Udon Extern関数呼び出し
----
### スタティック関数
`[Udonの型名（モジュール）].[メソッド](引数1, ...)`

### コンストラクタ
`[Udonの型名（モジュール）].ctor(引数1, ...)`

### インスタンス関数
`[インスタンス変数].[メソッド](引数1, ...)`


リテラル
----
### 整数値

`100` `-88888` `42` など、
`SystemInt32`型として解釈される。

### 浮動小数（float）
`-1.0` `3.1415` `.333`など、
`SystemSingle`型として解釈される。

### 文字列
`'hello, world'` `"ああああああ"` など
`SystemInt32`型として解釈される。

### 真偽値
`False`もしくは`True`、
`SystemBoolean`型として解釈される。

変数
----

### 宣言方法
* 宣言は **コードの一番最初** の代入で自動的に行われる。
* 変数の型は右辺の式の結果の型が設定される。
* 右辺を型名にすると代入せずに変数を宣言できる。
* 変数の有効範囲は、そのコード中のその宣言より下から末尾までである。

```py
# 1がSystemInt32型なので、aの型もSystemInt32型になる
a = 1
# 1.23がSystemSingle型なので、bの型もSystemSingle型になる
b = 1.23
# この場合、cはSystemInt32型になる
c = 1 + 100 * a
# この場合はcolorは未初期化で型になる
color = UnityEngineColor
```

### global変数
コードの先頭で`global 変数名`と書くとその変数はglobalになる。

ユーザイベントなどで未初期化のglobal変数が必要な場合は以下のようにする必要がある。
```py
global x
x = SystemInt32
```
### 代入
* `変数名 = 式`と書くと代入が行える。
* 右辺の結果の型と変数の型は**必ず**一致させる必要がある
```py
# 変数宣言、xの型はSysteint32になる
x = 10000
# xの値を200にする
x = 200
#右辺の型はSystemSingleなので
x = 3.333333



```

### 型（代表的な型）



配列
---
言語レベルでは配列は実装いていないので
Udonで使える`***Array`クラスを使用する。

配列の宣言
```py
# SystemInt32の配列を作成する
arr = SystemInt32Array.ctor(10)
```

配列へのアクセス
```py
# 配列の3番目に100を入れる
arr.Set(3, 100)
# こうやっても書ける
arr[3] = 100

# 配列の5番目から要素を取り出す
a = arr.Get(5)
# こうやっても書ける
a = arr[5]
```


演算子
----
サポートしている演算子は以下の通り
### 二項演算子

 `+`, `-`, `*`, `/`
 (%も実装予定)

* 演算子の両側は **必ず** 同じ型である必要がある。
* 演算の結果は元の型と同じになる。

### 比較演算子

`==`, `!=`, `<`, `>`, `<=`, `>=`

* 数値間の比較を行う。
* 演算子の両側は **必ず** 同じ型で比較可能である必要がある。
* 演算の結果は`SystemBoolean`になる。
* 


### 論理演算

 `and`, `or`, `not`


制御構文
----

### 代入文

### if文

### while文

### return文

### Import文（未実装）

キャスト
----


関数
----

```
def func1(x_1: SystemInt32, y_1: SystemInt32) -> SystemInt32:
  return 2 * x_1 + y_1
```


注意点
----

予約語
----
